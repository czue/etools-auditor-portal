<!--import [polymer, paper-fab, paper-icon-button, paper-input, etools-checkable-input, iron-icons/communication-icons]-->
<!--import [tab-inputs-styles, repeatable-data-sets-behavior, custom-validator, permission-controller]-->

<dom-module id="staff-members-tab-form">
    <template>
        <!-- inject styles './staff-members-tab-form.scss'-->
        <style include="tab-inputs-styles"></style>

        <div hidden$="[[_emptyList(dataItems.length)]]">
            <template is="dom-repeat" items="{{dataItems}}">


                <div class="row-h repeatable-item-container">
                    <div class="repeatable-item-actions">
                        <div class="row-v actions">
                            <paper-icon-button class="action delete"
                                               on-tap="_openDeleteConfirmation"
                                               data-args$="[[index]]"
                                               disabled="[[!_canBeRemoved(index)]]"
                                               hidden$="[[!_canBeRemoved(index)]]"
                                               icon="cancel"></paper-icon-button>
                        </div>
                    </div>
                    <div class="repeatable-item-content">
                        <div class="row-h group">
                            <div class="input-container" title="{{_getTitleValue(item.user.profile.job_title)}}">
                                <!-- Position -->
                                <paper-input label="Position"
                                             value="{{item.user.profile.job_title}}"
                                             placeholder="&#8212;"
                                             disabled$="[[isReadOnly('user.profile.job_title', basePermissionPath)]]"
                                             class$="disabled-as-readonly {{_setRequired('user.profile.job_title', basePermissionPath)}}"
                                             required="{{_setRequired('user.profile.job_title', basePermissionPath)}}">
                                </paper-input>
                            </div>
                            <div class="input-container" title="{{_getTitleValue(item.user.first_name)}}">
                                <!-- First Name -->
                                <paper-input label="First Name"
                                             value="{{item.user.first_name}}"
                                             placeholder="&#8212;"
                                             disabled$="[[isReadOnly('user.first_name', basePermissionPath)]]"
                                             class$="disabled-as-readonly validate-input {{_setRequired('user.first_name', basePermissionPath)}}"
                                             required="{{_setRequired('user.first_name', basePermissionPath)}}"
                                             on-focus="_resetFieldError"
                                             error-message="First name is required">
                                </paper-input>
                            </div>
                            <div class="input-container" title="{{_getTitleValue(item.user.last_name)}}">
                                <!-- Last Name -->
                                <paper-input label="Last Name"
                                             value="{{item.user.last_name}}"
                                             placeholder="&#8212;"
                                             disabled$="[[isReadOnly('user.last_name', basePermissionPath)]]"
                                             class$="disabled-as-readonly validate-input {{_setRequired('user.last_name', basePermissionPath)}}"
                                             required="{{_setRequired('user.last_name', basePermissionPath)}}"
                                             on-focus="_resetFieldError"
                                             error-message="Last name is required">
                                </paper-input>
                            </div>
                        </div>
                        <div class="row-h group">
                            <div class="input-container" title="{{_getTitleValue(item.user.profile.phone_number)}}">
                                <!-- Phone number -->
                                <paper-input label="Phone number"
                                             value="{{item.user.profile.phone_number}}"
                                             allowed-pattern="[\d]"
                                             placeholder="&#8212;"
                                             disabled$="[[isReadOnly('user.profile.phone_number', basePermissionPath)]]"
                                             class$="disabled-as-readonly {{_setRequired('user.profile.phone_number', basePermissionPath)}}"
                                             required="{{_setRequired('user.profile.phone_number', basePermissionPath)}}">
                                    <iron-icon prefix icon="communication:phone"></iron-icon>
                                </paper-input>
                            </div>
                            <div class="input-container" title="{{_getTitleValue(item.user.email)}}">
                                <!-- Email address -->
                                <paper-input label="E-mail address"
                                             value="{{item.user.email}}"
                                             placeholder="&#8212;"
                                             disabled$="[[isReadOnly('user.email', basePermissionPath)]]"
                                             class$="disabled-as-readonly validate-input {{_setRequired('user.email', basePermissionPath)}}"
                                             validator="emailValidator"
                                             required="{{_setRequired('user.email', basePermissionPath)}}"
                                             on-focus="_resetFieldError"
                                             error-message="A valid email address is required">
                                    <iron-icon prefix icon="communication:email"></iron-icon>
                                </paper-input>
                            </div>

                        </div>

                        <div class="row-h group">
                            <!-- Active? -->
                            <div class="staff-check-box active-box input-container">
                                <etools-checkable-input checked="{{item.user.is_active}}"
                                                        label="Active staff member?"
                                                        type="checkbox"
                                                        label-alignment="right"
                                                        readonly$="[[isReadOnly('user.is_active', basePermissionPath)]]">
                                </etools-checkable-input>
                            </div>
                            <!--receive notification-->
                            <div class="staff-check-box notify-box input-container input-container-ms">
                                <etools-checkable-input checked="{{item.receive_audit_notifications}}"
                                                        label="Receive notification?"
                                                        type="checkbox"
                                                        label-alignment="right"
                                                        readonly$="[[isReadOnly('receive_audit_notifications', basePermissionPath)]]">
                                </etools-checkable-input>
                            </div>
                        </div>

                    </div>
                </div>

            </template>
        </div>

        <custom-validator id="email-validator" validator-name="emailValidator"></custom-validator>

        <div class="row-h" hidden$="[[!_emptyList(dataItems.length)]]">
            <p>There are no assessments added.</p>
        </div>

        <div id="bottom-actions" class="row-h" hidden$="[[!_canBeRemoved(basePermissionPath)]]">
            <paper-fab icon="add"
                       on-tap="_addNewStaffMember"
                       title="Add"></paper-fab>
        </div>

    </template>

    <!-- inject scripts './staff-members-tab-form.js'-->
</dom-module>